<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>EGM Personel Başvuru</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        body { margin: 0; background: linear-gradient(135deg, #0f172a 0%, #162447 100%); color: white; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        .card { width: 600px; height: 550px; background: rgba(22, 36, 71, 0.95); border-radius: 15px; padding: 40px; text-align: center; position: relative; display: flex; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); }
        
        /* LOGO AYARI: egmm.png dosyasını klasöre attığından emin ol */
        .logo { width: 120px; height: auto; margin-bottom: 15px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.2)); }
        
        .question-box { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        input, textarea { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; padding: 15px; width: 85%; border-radius: 5px; font-size: 1.1rem; margin-top: 15px; transition: 0.3s; }
        input:focus, textarea:focus { border-color: #ffd700; outline: none; background: rgba(255,255,255,0.15); }
        textarea { height: 120px; resize: none; }
        
        .footer { display: flex; justify-content: space-between; margin-top: auto; }
        .btn { padding: 12px 35px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1rem; transition: 0.2s; }
        .btn-next { background: #e43f5a; color: white; } .btn-next:hover { background: #c0354a; }
        .btn-back { background: transparent; color: #aaa; border: 1px solid #aaa; } .btn-back:hover { color: white; border-color: white; }
        
        .progress-bar { position: absolute; top: 0; left: 0; height: 5px; background: #ffd700; width: 0%; transition: 0.3s; border-radius: 15px 15px 0 0; }
    </style>
</head>
<body>

<div class="card">
    <div class="progress-bar" id="pBar"></div>
    
    <img src="egmm.png" class="logo" alt="EGM Logo">
    
    <div class="question-box" id="qBox"></div>
    
    <div class="footer">
        <button class="btn btn-back" id="bBack" onclick="nav(-1)">GERİ</button>
        <button class="btn btn-next" id="bNext" onclick="nav(1)">BAŞLA</button>
    </div>
</div>

<script src="config.js"></script>
<script>
    const q = [
        {id:'i', t:'info', h:'EGM PERSONEL ALIM', s:'Başvurunuz titizlikle incelenecektir.<br>Yanlış bilgi vermek yasaklanma sebebidir.'},
        {id:'discord_id', t:'text', h:'KİMLİK DOĞRULAMA', s:'Discord ID Giriniz:'},
        {id:'ic_isim', t:'text', h:'KİMLİK BİLGİLERİ', s:'Karakter Adı ve Soyadı (IC):'},
        {id:'ooc_yas', t:'number', h:'KİŞİSEL BİLGİLER', s:'Gerçek Yaşınız (OOC):'},
        {id:'s1', t:'textarea', h:'MÜLAKAT - 1', s:'Neden polis olmak istiyorsunuz? Karakter hikayenizden bahsedin.'},
        {id:'s2', t:'textarea', h:'MÜLAKAT - 2', s:'Powergaming ve Metagaming kavramlarını örnek vererek açıklayınız.'},
        {id:'s3', t:'textarea', h:'MÜLAKAT - 3', s:'Devriye sırasında üst rütbeniz size sivili vurmanızı emrederse ne yaparsınız?'},
        {id:'s4', t:'textarea', h:'MÜLAKAT - 4', s:'Trafik kontrolünde durdurduğunuz araçtan inen kişiler size silah çekerse tepkiniz ne olur?'},
        {id:'s5', t:'number', h:'AKTİFLİK', s:'Sunucuda günde kaç saat aktif olabilirsiniz?'}
    ];
    
    let idx = 0; 
    let ans = {};

    function render() {
        const item = q[idx];
        const box = document.getElementById('qBox');
        const bNext = document.getElementById('bNext');
        const bBack = document.getElementById('bBack');
        
        let inputHTML = item.t === 'info' ? '' : (item.t==='textarea' ? `<textarea id="inp"></textarea>` : `<input type="${item.t}" id="inp">`);
        
        box.innerHTML = `<h2 style="color:#ffd700; margin:0 0 10px 0;">${item.h}</h2><p style="font-size:1.1rem; color:#ddd; max-width:90%;">${item.s}</p>${inputHTML}`;
        
        if(item.t !== 'info' && document.getElementById('inp')) {
            document.getElementById('inp').value = ans[item.id] || '';
            document.getElementById('inp').focus();
        }

        bBack.style.visibility = idx === 0 ? 'hidden' : 'visible';
        bNext.innerText = idx === 0 ? 'BAŞLA' : (idx === q.length-1 ? 'GÖNDER' : 'İLERİ');
        document.getElementById('pBar').style.width = ((idx / (q.length-1))*100) + '%';
    }

    function nav(d) {
        if(d === 1 && idx > 0) {
            const val = document.getElementById('inp').value.trim();
            if(!val) return alert('Lütfen bu alanı boş bırakmayınız!');
            ans[q[idx].id] = val;
        }
        
        if(d === 1 && idx === q.length-1) return send();
        
        idx += d;
        render();
    }

    function send() {
        const btn = document.getElementById('bNext');
        btn.innerText = 'GÖNDERİLİYOR...';
        btn.disabled = true;
        
        const data = { discord_id: ans.discord_id, ic_isim: ans.ic_isim, ooc_yas: ans.ooc_yas, durum: 'Beklemede', tarih: new Date().toISOString(), cevaplar: ans };
        
        database.ref('basvurular').push(data, (err) => {
            if(err) { alert("Hata: " + err.message); btn.disabled = false; return; }
            document.querySelector('.card').innerHTML = `
                <img src="egmm.png" class="logo" style="width:100px;">
                <h1 style="color:#28a745; margin-top:20px;">BAŞVURU ALINDI ✅</h1>
                <p style="font-size:1.1rem;">Başvurunuz sisteme kaydedildi.<br>Sonuçları ana sayfadan takip edebilirsiniz.</p>
                <button onclick="window.location.href='index.html'" class="btn" style="background:#007bff; color:white; margin-top:30px;">Ana Sayfaya Dön</button>
            `;
        });
    }
    
    render();
</script>
</body>
</html>
