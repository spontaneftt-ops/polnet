<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLNET v4.5 - Emniyet TeÅŸkilatÄ± YÃ¶netim Sistemi</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root { --bg-dark: #0f172a; --sidebar-bg: #020617; --card-bg: #1e293b; --text-main: #f1f5f9; --text-muted: #94a3b8; --border: #334155; --accent: #3b82f6; --danger: #ef4444; --success: #10b981; --warning: #f59e0b; }
        
        * { box-sizing: border-box; outline: none; }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg-dark); color: var(--text-main); display: flex; height: 100vh; overflow: hidden; font-size: 14px; transition: background 0.5s ease; }

        /* OHAL MODU */
        body.ohal-active { 
            --bg-dark: #2a0505; --sidebar-bg: #1a0000; --card-bg: #3f0a0a; --accent: #ff0000; --border: #5c1818; 
            animation: redPulse 2s infinite alternate;
        }
        @keyframes redPulse { 0% { box-shadow: inset 0 0 0 0 rgba(255, 0, 0, 0); } 100% { box-shadow: inset 0 0 100px 30px rgba(255, 0, 0, 0.4); } }
        
        #ohalAlertBar { 
            background: #000; color: red; font-family: 'Chakra Petch', sans-serif; font-weight: 900; font-size: 1.5rem; 
            padding: 10px 0; border-bottom: 4px solid red; white-space: nowrap; overflow: hidden; display: none; z-index: 9999; 
            position: fixed; top: 0; width: 100%; letter-spacing: 2px;
        }
        .ohal-content { display: inline-block; padding-left: 100%; animation: ohalScroll 15s linear infinite; }
        @keyframes ohalScroll { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        /* LAYOUT */
        .sidebar { width: 280px; background: var(--sidebar-bg); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 15px; overflow-y: auto; z-index: 10; padding-bottom: 50px; }
        .content { flex: 1; padding: 30px; overflow-y: auto; position: relative; background-image: radial-gradient(var(--card-bg) 1px, transparent 1px); background-size: 20px 20px; padding-bottom: 50px; }
        body.ohal-active .sidebar, body.ohal-active .content { margin-top: 50px; }

        .menu-item { padding: 12px; margin-bottom: 5px; cursor: pointer; border-radius: 6px; display: flex; align-items: center; gap: 10px; color: var(--text-muted); transition: 0.2s; font-weight: 500; font-family: 'Chakra Petch', sans-serif; letter-spacing: 0.5px; }
        .menu-item:hover, .active-tab { background: rgba(59,130,246,0.15); color: white; border-left: 3px solid var(--accent); }
        
        .card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 10px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        h1, h2, h3 { font-family: 'Chakra Petch', sans-serif; margin-top: 0; }
        
        input, select, textarea { width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid var(--border); color: white; border-radius: 6px; margin-bottom: 10px; font-family: 'Inter', sans-serif; transition: 0.3s; }
        input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(59,130,246,0.2); }
        option { background: var(--card-bg); color: white; }

        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; display: inline-flex; align-items: center; gap: 5px; justify-content: center; font-family: 'Chakra Petch', sans-serif; text-transform: uppercase; transition: 0.2s; }
        .btn:hover { transform: translateY(-2px); filter: brightness(1.1); }
        .btn-blue { background: var(--accent); } .btn-green { background: var(--success); } .btn-red { background: var(--danger); } .btn-dark { background: #334155; } .btn-yellow { background: #f59e0b; color:black; }
        
        table { width: 100%; border-collapse: collapse; background: var(--card-bg); border-radius: 8px; overflow: hidden; margin-bottom: 20px; }
        th { background: rgba(0,0,0,0.4); color: var(--accent); padding: 15px; text-align: left; border-bottom: 2px solid var(--border); font-family: 'Chakra Petch', sans-serif; }
        td { padding: 15px; border-bottom: 1px solid var(--border); }
        tr:hover td { background: rgba(255,255,255,0.02); }

        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.85); z-index: 3000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: var(--card-bg); width: 70%; max-height: 90vh; border-radius: 12px; border: 1px solid var(--border); display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5); animation: zoomIn 0.2s; }
        @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-header { padding: 20px; background: rgba(0,0,0,0.3); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .modal-body { padding: 25px; overflow-y: auto; }

        #loginScreen { position: fixed; top:0; left:0; width:100%; height:100%; background: #020617; z-index: 9999; display: flex; justify-content: center; align-items: center; background-image: radial-gradient(circle at center, #1e293b 0%, #020617 100%); }
        .tab-content { display: none; } .tab-content.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; } }
        
        .badge { padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge-blue { background: rgba(59,130,246,0.2); color: var(--accent); border: 1px solid var(--accent); }
        .badge-red { background: rgba(239, 68, 68, 0.2); color: var(--danger); border: 1px solid var(--danger); }
        .badge-green { background: rgba(16, 185, 129, 0.2); color: var(--success); border: 1px solid var(--success); }
        .badge-warn { background: rgba(245, 158, 11, 0.2); color: var(--warning); border: 1px solid var(--warning); }
        .badge-purple { background: rgba(147, 51, 234, 0.2); color: #c084fc; border: 1px solid #c084fc; }
        .badge-gold { background: rgba(255, 215, 0, 0.2); color: #ffd700; border: 1px solid #ffd700; }

        .mesai-card { text-align: center; border: 2px solid var(--border); transition: 0.3s; }
        .mesai-active { border-color: var(--success); background: rgba(16, 185, 129, 0.05); }
        #mesaiSayac { font-size: 3rem; font-family: 'Chakra Petch', monospace; font-weight: bold; margin: 20px 0; }
        
        .ceza-item { padding: 12px; border-bottom: 1px solid var(--border); cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; font-size: 0.9rem; }
        .ceza-item:hover { background: rgba(255,255,255,0.05); }
        .ceza-item.selected { background: rgba(59,130,246,0.2); border-left: 4px solid var(--accent); }
        .ceza-code { color: var(--text-muted); font-family: 'Chakra Petch'; margin-right: 10px; width: 60px; display:inline-block; font-weight:bold; }
    </style>
</head>
<body>

<div id="ohalAlertBar"><div class="ohal-content">âš ï¸ DÄ°KKAT: OLAÄANÃœSTÃœ HAL (OHAL) Ä°LAN EDÄ°LMÄ°ÅTÄ°R! âš ï¸ TÃœM Ä°ZÄ°NLER Ä°PTAL. SOKAÄA Ã‡IKMA YASAÄI AKTÄ°F. ÅÃœPHELÄ° GÃ–RÃœLEN HERKES GÃ–ZALTINA ALINACAKTIR.</div></div>

<div id="loginScreen">
    <div style="background:var(--card-bg); padding:50px; border-radius:15px; width:400px; text-align:center; border:1px solid var(--border); box-shadow: 0 0 80px rgba(0,0,0,0.6);">
        <img src="egmm.png" style="width:100px; margin-bottom:20px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.2));" onerror="this.src='https://cdn-icons-png.flaticon.com/512/9203/9203764.png'">
        <h2 style="margin:0; color:white; letter-spacing: 2px;">POLNET v4.5</h2>
        <p style="color:var(--text-muted); margin-bottom:30px;">Emniyet Genel MÃ¼dÃ¼rlÃ¼ÄŸÃ¼ Personel GiriÅŸi</p>
        <input type="text" id="kadi" placeholder="Sicil No">
        <input type="password" id="sifre" placeholder="Åifre">
        <button onclick="girisYap()" class="btn btn-blue" style="width:100%; margin-top:10px; padding: 15px;">SÄ°STEME GÄ°RÄ°Å YAP</button>
        <p id="loginMsg" style="color:var(--danger); margin-top:15px;"></p>
        <p style="font-size:10px; color:#555;">v4.5 Stable - Authorized Personnel Only</p>
    </div>
</div>

<div id="adminPanel" style="display:none; width:100%;">
    <div class="sidebar">
        <div style="text-align:center; margin-bottom:20px; padding-bottom:20px; border-bottom:1px solid var(--border);">
            <img src="egmm.png" style="width:70px; margin-bottom:10px;" onerror="this.src='https://cdn-icons-png.flaticon.com/512/9203/9203764.png'">
            <h3 style="margin:0; font-size:1.4rem;">POLNET</h3>
            <div id="aktifKullaniciAdi" style="font-weight:bold; color:white; margin-top:10px;"></div>
            <div id="aktifKullaniciRutbe" class="badge badge-blue" style="margin-top:5px; display:inline-block;">YÃœKLENÄ°YOR...</div>
        </div>

        <div class="menu-item active-tab" onclick="tabDegistir('dashboardTab', this)"><i class="fas fa-chart-pie"></i> Ã–zet Durum</div>
        <div class="menu-item" onclick="tabDegistir('basvuruTab', this)"><i class="fas fa-clipboard-list"></i> BaÅŸvurular <span id="basvuruBadge" class="badge badge-red" style="margin-left:auto; display:none;">0</span></div>
        <div class="menu-item" onclick="tabDegistir('mesaiTab', this)"><i class="fas fa-clock"></i> Mesai Ä°ÅŸlemleri</div>
        <div class="menu-item" onclick="tabDegistir('ruhsatTab', this)"><i class="fas fa-id-card"></i> Silah RuhsatlarÄ±</div>
        <div class="menu-item" onclick="tabDegistir('cezaRehberTab', this)"><i class="fas fa-book"></i> TCK VeritabanÄ±</div>
        <div class="menu-item" onclick="tabDegistir('gbtTab', this)"><i class="fas fa-fingerprint"></i> GBT Sorgu & Ä°ÅŸlem</div>
        <div class="menu-item" onclick="tabDegistir('aracTab', this)"><i class="fas fa-car"></i> AraÃ§ & Trafik</div>
        
        <div id="menuPersonel" class="menu-item" onclick="tabDegistir('personelTab', this)"><i class="fas fa-users-cog"></i> Personel YÃ¶netimi</div>
        
        <div style="margin-top:auto;">
            <button id="ohalBtn" onclick="ohalDegistir()" class="btn btn-red" style="width:100%; margin-bottom:10px; padding:15px; font-size:1rem;">ğŸš¨ OHAL BAÅLAT</button>
            <button onclick="location.reload()" class="btn btn-dark" style="width:100%;">GÃœVENLÄ° Ã‡IKIÅ</button>
        </div>
    </div>

    <div class="content">
        <div id="dashboardTab" class="tab-content active">
            <h1 style="margin-bottom:20px;">Komuta Merkezi</h1>
            <div class="grid-3">
                <div class="card" style="border-left:4px solid var(--warning);"><h3>Bekleyen BaÅŸvuru</h3><h1 id="statBasvuru">0</h1></div>
                <div class="card" style="border-left:4px solid var(--danger);"><h3>Aranan ÅahÄ±s</h3><h1 id="statAranan">0</h1></div>
                <div class="card" style="border-left:4px solid var(--success);"><h3>Aktif Devriye</h3><h1 id="statAktifPersonel">0</h1></div>
            </div>
            <div class="card">
                <h3><i class="fas fa-shield-alt"></i> Organize SuÃ§larla MÃ¼cadele GÃ¼ncellemesi v4.5</h3>
                <p>Yeni TÃ¼rk Ceza Kanunu veritabanÄ± sisteme entegre edildi. GerÃ§ekÃ§i suÃ§ tanÄ±mlarÄ±, kamu cezasÄ± (maksimum 100 birim) ve dengeli para cezalarÄ± ayarlandÄ±. Personel rÃ¼tbe sistemi aktif edildi. Discord Webhook entegrasyonu saÄŸlandÄ±.</p>
            </div>
        </div>

        <div id="basvuruTab" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center;"><h1>Gelen BaÅŸvurular</h1><button onclick="verileriYukle()" class="btn btn-dark"><i class="fas fa-sync"></i> Yenile</button></div>
            <div class="card">
                <input type="text" id="basvuruAra" placeholder="Ä°sim veya Discord ID ara..." onkeyup="tabloAra('basvuruAra','basvuruListesi')">
                <table><thead><tr><th>Tarih</th><th>Discord ID</th><th>IC Ä°sim</th><th>Durum</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="basvuruListesi"></tbody></table>
            </div>
            <div class="card"><h3>ğŸš« Kara Liste</h3><div style="display:flex; gap:10px;"><input id="bl_id" placeholder="Discord ID"><input id="bl_sebep" placeholder="Sebep"><button onclick="karaListeyeEkle()" class="btn btn-red">EKLE</button></div><div id="blacklistContainer" style="margin-top:10px; max-height:150px; overflow-y:auto;"></div></div>
        </div>

        <div id="ruhsatTab" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h1>Silah RuhsatÄ± YÃ¶netimi</h1>
                <button onclick="modalAc('ruhsatEkleModal')" class="btn btn-blue">+ YENÄ° RUHSAT TANIMLA</button>
            </div>
            <div class="card">
                <input type="text" id="ruhsatAra" placeholder="Ruhsat sahibi adÄ± ara..." onkeyup="tabloAra('ruhsatAra','ruhsatListesi')">
                <table>
                    <thead><tr><th>Ruhsat Sahibi</th><th>Ruhsat Tipi</th><th>GeÃ§erlilik Tarihi</th><th>Veren Memur</th><th>Ä°ÅŸlem</th></tr></thead>
                    <tbody id="ruhsatListesi"></tbody>
                </table>
            </div>
        </div>

        <div id="cezaRehberTab" class="tab-content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h1>Ceza Kanunu Rehberi (TCK)</h1>
            </div>
            <p style="color:var(--text-muted);">AÅŸaÄŸÄ±daki liste Adalet BakanlÄ±ÄŸÄ± onaylÄ± gÃ¼ncel ceza listesidir.</p>
            <div class="card" style="height:600px; overflow-y:auto;">
                <input id="tckAra" placeholder="Kanun kodu veya adÄ± ara... (Ã–rn: TRF-01)" onkeyup="tabloAra('tckAra','tckEditListesi')">
                <table>
                    <thead><tr><th>Kod</th><th>SuÃ§ TanÄ±mÄ±</th><th>Para CezasÄ±</th><th>Kamu CezasÄ± (Hapis)</th></tr></thead>
                    <tbody id="tckEditListesi"></tbody>
                </table>
            </div>
        </div>

        <div id="mesaiTab" class="tab-content">
            <h1>Mesai Ä°ÅŸlemleri</h1>
            <div class="card mesai-card" id="kisiselMesaiKart">
                <h3 id="mesaiDurumText" style="color:var(--text-muted);">MESAÄ° DIÅI</h3>
                <div id="mesaiSayac">00:00:00</div>
                <button onclick="mesaiToggle()" id="btnMesai" class="btn btn-green" style="font-size:1.5rem; padding:15px 50px;">MESAÄ°YE BAÅLA</button>
            </div>
            <div class="card">
                <h3><i class="fas fa-users"></i> Aktif Personeller</h3>
                <table id="aktifMesaiTablo"><thead><tr><th>Personel</th><th>RÃ¼tbe</th><th>BaÅŸlangÄ±Ã§ Saati</th><th>Aktif SÃ¼re</th></tr></thead><tbody id="aktifMesaiBody"></tbody></table>
            </div>
        </div>

        <div id="gbtTab" class="tab-content">
            <h1>GBT Sorgu & Ceza Sistemi</h1>
            <div class="card">
                <div class="grid-2"><input id="gbtInput" placeholder="VatandaÅŸ AdÄ±..."><button onclick="gbtSorgula()" class="btn btn-green">SORGULA</button></div>
            </div>
            <div id="gbtSonuc"></div>
            <button onclick="cezaModalAc()" class="btn btn-red" style="width:100%; margin-top:20px; padding:20px; font-size:1.2rem;">âš–ï¸ YENÄ° CEZA / SABIKA KAYDI OLUÅTUR</button>
        </div>

        <div id="aracTab" class="tab-content">
            <h1>Trafik Åube</h1>
            <div class="card" style="text-align:center;">
                <input id="plakaInput" placeholder="PLAKA (34 TR 34)" style="text-align:center; font-size:3rem; text-transform:uppercase; letter-spacing:5px; font-family:'Chakra Petch'; width:60%;">
                <br><br>
                <button onclick="plakaSorgula()" class="btn btn-green" style="padding:15px 40px; font-size:1.2rem;">SORGULA</button>
            </div>
            <div id="aracSonuc" style="margin-top:20px;"></div>
        </div>

        <div id="personelTab" class="tab-content">
            <h1>Personel YÃ¶netimi</h1>
            <div class="card">
                <div class="grid-3">
                    <input id="yeniKadi" placeholder="Sicil No">
                    <input id="yeniSifre" placeholder="Åifre">
                    <select id="yeniRutbe">
                        <option value="0">Polis Memuru</option>
                        <option value="1">BaÅŸ Polis</option>
                        <option value="2">KÄ±demli BaÅŸ Polis</option>
                        <option value="3">Komiser YardÄ±mcÄ±sÄ±</option>
                        <option value="4">Komiser</option>
                        <option value="5">BaÅŸ Komiser</option>
                        <option value="6">Emniyet Amiri</option>
                        <option value="7">4. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼</option>
                        <option value="8">3. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼</option>
                        <option value="9">2. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼</option>
                        <option value="10">1. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼</option>
                    </select>
                </div>
                <button onclick="personelEkle()" class="btn btn-green" style="width:100%">PERSONEL EKLE</button>
            </div>
            <table><thead><tr><th>Sicil</th><th>RÃ¼tbe</th><th>Åifre</th><th>Ä°ÅŸlem</th></tr></thead><tbody id="personelListesi"></tbody></table>
        </div>
    </div>
</div>

<div id="basvuruModal" class="modal"><div class="modal-content"><div class="modal-header"><h3>BaÅŸvuru Ä°nceleme</h3><span onclick="modalKapat()" style="cursor:pointer; font-size:1.5rem;">&times;</span></div><div class="modal-body"><div id="basvuruDetayIcerik"></div><hr style="border-color:var(--border); margin:20px 0;"><div id="basvuruIslemButtonlari" class="grid-3"></div></div></div></div>

<div id="ruhsatEkleModal" class="modal">
    <div class="modal-content">
        <div class="modal-header"><h3>Yeni Silah RuhsatÄ±</h3><span onclick="modalKapat()" style="cursor:pointer;">&times;</span></div>
        <div class="modal-body">
            <input id="ruh_sahip" placeholder="Ruhsat Sahibi (Ad Soyad)">
            <select id="ruh_tip">
                <option value="Silah TaÅŸÄ±ma">Silah TaÅŸÄ±ma RuhsatÄ±</option>
                <option value="Silah Bulundurma">Silah Bulundurma RuhsatÄ±</option>
                <option value="Av TÃ¼feÄŸi">Av TÃ¼feÄŸi RuhsatÄ±</option>
            </select>
            <label style="color:var(--text-muted); font-size:0.8rem;">GeÃ§erlilik Tarihi:</label>
            <input type="date" id="ruh_tarih">
            <button onclick="ruhsatKaydet()" class="btn btn-green" style="width:100%; margin-top:10px;">RUHSATI OLUÅTUR</button>
        </div>
    </div>
</div>

<div id="cezaModal" class="modal">
    <div class="modal-content">
        <div class="modal-header"><h3>Adalet BakanlÄ±ÄŸÄ± Ceza Sistemi</h3><span onclick="modalKapat()" style="cursor:pointer;">&times;</span></div>
        <div class="modal-body">
            <input id="ceza_sahis" placeholder="SuÃ§lu AdÄ± SoyadÄ±..." style="border:2px solid var(--accent);">
            <div class="grid-2"><input id="ceza_ara" placeholder="SuÃ§ Kodu veya AdÄ± Ara..." onkeyup="cezaFiltrele()"><button onclick="cezaSifirla()" class="btn btn-dark">SeÃ§imleri Temizle</button></div>
            <div style="height:400px; overflow-y:auto; border:1px solid #334155; padding:10px; margin-bottom:15px;" id="cezaListesiContainer">
                </div>
            <div style="background:#0f172a; padding:15px; text-align:center; border-radius:8px;">
                <h2 id="toplamTutar" style="color:var(--danger); margin:0;">0 TL / 0 Kamu (Hapis)</h2>
            </div>
            <button onclick="cezayiKes()" class="btn btn-red" style="width:100%; margin-top:15px; padding:15px;">CEZAYI ONAYLA VE Ä°ÅLE</button>
        </div>
    </div>
</div>

<script src="config.js"></script>
<script>
    // --- KONFÄ°GÃœRASYON ---
    const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1463704048376090779/NM94elMs7luZy6cXPvZFh4Ed2OsWQ-oU033418hdr4uwqJZ4Mcwyj4mTjIholI87UeyC";

    // --- GLOBALS ---
    let aktifKullanici = "";
    let aktifRutbeId = 0; 
    let seciliBasvuruId = "";
    let seciliBasvuruData = null; 
    let myShiftStart = null;
    let myShiftTimer = null;
    let tckDb = []; 

    // --- RÃœTBE TANIMLARI ---
    const RUTBELER = [
        { id: 0, ad: "Polis Memuru", class: "badge-blue" },
        { id: 1, ad: "BaÅŸ Polis", class: "badge-blue" },
        { id: 2, ad: "KÄ±demli BaÅŸ Polis", class: "badge-blue" },
        { id: 3, ad: "Komiser YardÄ±mcÄ±sÄ±", class: "badge-purple" },
        { id: 4, ad: "Komiser", class: "badge-purple" },
        { id: 5, ad: "BaÅŸ Komiser", class: "badge-purple" }, // Panel GÃ¶rme SÄ±nÄ±rÄ±
        { id: 6, ad: "Emniyet Amiri", class: "badge-gold" },
        { id: 7, ad: "4. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼", class: "badge-gold" },
        { id: 8, ad: "3. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼", class: "badge-gold" },
        { id: 9, ad: "2. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼", class: "badge-gold" },
        { id: 10, ad: "1. SÄ±nÄ±f Emniyet MÃ¼dÃ¼rÃ¼", class: "badge-red" } // Silme Yetkisi SÄ±nÄ±rÄ±
    ];

    function getRutbeAd(id) { return RUTBELER[id] ? RUTBELER[id].ad : "Polis Memuru"; }
    function getRutbeClass(id) { return RUTBELER[id] ? RUTBELER[id].class : "badge-blue"; }

    // --- GERÃ‡EKÃ‡Ä° TCK LÄ°STESÄ° ---
    const REALISTIC_TCK = [
        {code: "TRF-01", ad: "HatalÄ± Park / Park Ä°hlali", p: 1500, h: 0},
        {code: "TRF-02", ad: "KÄ±rmÄ±zÄ± IÅŸÄ±k Ä°hlali", p: 2000, h: 0},
        {code: "TRF-03", ad: "HÄ±z SÄ±nÄ±rÄ±nÄ± AÅŸmak (+%10)", p: 2500, h: 0},
        {code: "TRF-04", ad: "HÄ±z SÄ±nÄ±rÄ±nÄ± AÅŸmak (+%50)", p: 6000, h: 0},
        {code: "TRF-05", ad: "Ehliyetsiz AraÃ§ Kullanmak", p: 10000, h: 0},
        {code: "TRF-06", ad: "AlkollÃ¼ AraÃ§ Kullanmak (1. Seviye)", p: 8000, h: 0},
        {code: "TRF-07", ad: "AlkollÃ¼ AraÃ§ Kullanmak (2. Seviye)", p: 15000, h: 5},
        {code: "TRF-08", ad: "Trafik GÃ¼venliÄŸini Tehlikeye Atmak", p: 5000, h: 2},
        {code: "TRF-09", ad: "Dur Ä°htarÄ±na Uymamak", p: 7500, h: 3},
        {code: "TRF-10", ad: "Trafik KazasÄ±na Sebebiyet Vermek", p: 10000, h: 0},
        {code: "ASY-01", ad: "Ã‡evreyi RahatsÄ±z Etmek", p: 2000, h: 0},
        {code: "ASY-02", ad: "Kamusal Alanda Maske/Kimlik Gizleme", p: 3500, h: 0},
        {code: "ASY-03", ad: "Polise Mukavemet", p: 10000, h: 10},
        {code: "ASY-04", ad: "Polise Hakaret", p: 7500, h: 5},
        {code: "ASY-05", ad: "Kavga Ã‡Ä±karmak", p: 5000, h: 2},
        {code: "ASY-06", ad: "Tehdit ve Åantaj", p: 12000, h: 10},
        {code: "ASY-07", ad: "Haneye TecavÃ¼z", p: 15000, h: 15},
        {code: "ASY-08", ad: "Mala Zarar Verme", p: 8000, h: 5},
        {code: "ASY-09", ad: "Kamu MalÄ±na Zarar Verme", p: 15000, h: 15},
        {code: "SDT-01", ad: "Basit Yaralama (Darp)", p: 10000, h: 10},
        {code: "SDT-02", ad: "SilahlÄ± Yaralama", p: 30000, h: 30},
        {code: "SDT-03", ad: "Adam Ã–ldÃ¼rmeye TeÅŸebbÃ¼s", p: 50000, h: 60},
        {code: "SDT-04", ad: "Kasten Adam Ã–ldÃ¼rme", p: 100000, h: 100},
        {code: "SDT-05", ad: "Taksirle Adam Ã–ldÃ¼rme", p: 40000, h: 40},
        {code: "SDT-06", ad: "Rehin Alma / Adam KaÃ§Ä±rma", p: 45000, h: 50},
        {code: "HRS-01", ad: "Basit HÄ±rsÄ±zlÄ±k", p: 5000, h: 5},
        {code: "HRS-02", ad: "AraÃ§ HÄ±rsÄ±zlÄ±ÄŸÄ±", p: 15000, h: 20},
        {code: "HRS-03", ad: "Gasp ve YaÄŸma", p: 25000, h: 30},
        {code: "HRS-04", ad: "Nitelikli Soygun (Ä°ÅŸyeri/Banka)", p: 60000, h: 70},
        {code: "HRS-05", ad: "DolandÄ±rÄ±cÄ±lÄ±k", p: 20000, h: 15},
        {code: "NRK-01", ad: "UyuÅŸturucu Kullanmak", p: 5000, h: 5},
        {code: "NRK-02", ad: "UyuÅŸturucu Bulundurmak (Az Miktar)", p: 10000, h: 10},
        {code: "NRK-03", ad: "UyuÅŸturucu SatÄ±cÄ±lÄ±ÄŸÄ± (TorbacÄ±lÄ±k)", p: 40000, h: 50},
        {code: "NRK-04", ad: "UyuÅŸturucu Ä°malatÄ± ve Ticareti", p: 80000, h: 90},
        {code: "SLH-01", ad: "RuhsatsÄ±z Silah Bulundurma", p: 15000, h: 10},
        {code: "SLH-02", ad: "RuhsatsÄ±z Silah Ticareti", p: 50000, h: 60},
        {code: "SLH-03", ad: "AteÅŸli Silah TeÅŸhiri (Korku Yaratma)", p: 10000, h: 15},
        {code: "SLH-04", ad: "Meskun Mahalde AteÅŸ Etme", p: 20000, h: 20},
        {code: "SLH-05", ad: "YasadÄ±ÅŸÄ± (AÄŸÄ±r) Silah Bulundurma", p: 60000, h: 70},
        {code: "ORG-01", ad: "SuÃ§ Ã–rgÃ¼tÃ¼ ÃœyeliÄŸi", p: 30000, h: 40},
        {code: "ORG-02", ad: "SuÃ§ Ã–rgÃ¼tÃ¼ LiderliÄŸi", p: 100000, h: 100},
        {code: "ORG-03", ad: "Devlete KarÅŸÄ± SuÃ§lar / TerÃ¶r", p: 150000, h: 120}
    ];

    // --- GÄ°RÄ°Å Ä°ÅLEMLERÄ° ---
    function girisYap() {
        const k = document.getElementById('kadi').value.trim();
        const s = document.getElementById('sifre').value.trim();
        
        // Admin Backdoor
        if(k === "admin" && s === "admin") { basariliGiris(k, 10); return; } 
        
        database.ref('personel').orderByChild('kadi').equalTo(k).once('value', sn => {
            let userFound = null;
            sn.forEach(c => { const data = c.val(); if(data.sifre === s) userFound = data; });
            
            if(userFound) {
                let r = userFound.rutbe !== undefined ? parseInt(userFound.rutbe) : 0;
                basariliGiris(k, r); 
            } else {
                document.getElementById('loginMsg').innerText = "HatalÄ± GiriÅŸ!";
            }
        });
    }

    function basariliGiris(k, r) {
        aktifKullanici = k;
        aktifRutbeId = r;
        
        document.getElementById('aktifKullaniciAdi').innerText = "Sicil: " + k;
        document.getElementById('aktifKullaniciRutbe').innerText = getRutbeAd(r);
        document.getElementById('aktifKullaniciRutbe').className = "badge " + getRutbeClass(r);
        
        // GÃ–RÃœNÃœRLÃœK KONTROLÃœ: BaÅŸ Komiser (5) ve altÄ± gÃ¶remez
        const personelMenuBtn = document.getElementById('menuPersonel');
        if (aktifRutbeId < 5) {
            personelMenuBtn.style.display = 'none';
        } else {
            personelMenuBtn.style.display = 'flex';
        }

        document.getElementById('loginScreen').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'flex';
        
        verileriYukle();
        basvurulariDinle();
        mesaiSistemiBaslat();
        tckVeritabaniHazirla();
    }

    function tckVeritabaniHazirla() {
        tckDb = REALISTIC_TCK;
        cezaListesiniOlustur();
        tckEditorListesiniGuncelle();
    }
    
    function tckEditorListesiniGuncelle() {
        const tb = document.getElementById('tckEditListesi');
        tb.innerHTML = "";
        tckDb.forEach(item => {
            tb.innerHTML += `<tr><td><span class="badge badge-purple">${item.code}</span></td><td>${item.ad}</td><td>${item.p.toLocaleString()} TL</td><td>${item.h} Kamu</td></tr>`;
        });
    }

    // --- PERSONEL YÃ–NETÄ°MÄ° (GELÄ°ÅMÄ°Å) ---
    function verileriYukle() {
        database.ref('personel').on('value', s => { 
            const tb = document.getElementById('personelListesi'); 
            tb.innerHTML = ""; 
            
            s.forEach(c => { 
                const p = c.val();
                let rId = p.rutbe !== undefined ? parseInt(p.rutbe) : 0; 
                let rAd = getRutbeAd(rId);
                let rClass = getRutbeClass(rId);
                
                // Buton MantÄ±ÄŸÄ±
                let islemButonu = "";
                let duzenleButonu = `<button onclick="rutbeGuncellePrompt('${c.key}', ${rId})" class="btn btn-yellow btn-sm" style="margin-right:5px;">DÃœZENLE</button>`;
                
                if(aktifRutbeId === 10) {
                    islemButonu = `<button onclick="personelSil('${c.key}')" class="btn btn-red btn-sm">SÄ°L</button>`;
                } 
                
                tb.innerHTML += `<tr><td>${p.kadi}</td><td><span class="badge ${rClass}">${rAd}</span></td><td>****</td><td style="display:flex; justify-content:center;">${duzenleButonu}${islemButonu}</td></tr>`; 
            }); 
        });

        database.ref('blacklist').on('value', s => { const d = document.getElementById('blacklistContainer'); d.innerHTML = ""; s.forEach(c => d.innerHTML += `<div style="margin-bottom:5px; border-bottom:1px solid #333;">${c.val().discord_id} (${c.val().sebep}) <button onclick="karaListeSil('${c.key}')" class="btn btn-red btn-sm">X</button></div>`); });
        ruhsatlariDinle();
        database.ref('gbt').on('value', s => { if(s.exists()) document.getElementById('statAranan').innerText = Object.keys(s.val()).length; });
    }

    function personelEkle() { 
        if(aktifRutbeId !== 10) return alert("YETKÄ°SÄ°Z Ä°ÅLEM: Sadece Emniyet MÃ¼dÃ¼rÃ¼ personel ekleyebilir.");
        const k = document.getElementById('yeniKadi').value;
        const s = document.getElementById('yeniSifre').value;
        const r = document.getElementById('yeniRutbe').value;
        if(!k || !s) return alert("Bilgileri doldurun!");
        database.ref('personel').push({ kadi: k, sifre: s, rutbe: parseInt(r) }); 
        alert("Personel Eklendi!");
    }

    function personelSil(key) {
        if(aktifRutbeId !== 10) return alert("YETKÄ°SÄ°Z Ä°ÅLEM: Sadece Emniyet MÃ¼dÃ¼rÃ¼ personel silebilir.");
        if(confirm("Bu personeli kalÄ±cÄ± olarak silmek istediÄŸinize emin misiniz?")) database.ref('personel/' + key).remove();
    }

    function rutbeGuncellePrompt(key, mevcutRutbe) {
        if(aktifRutbeId < 5) return alert("Yetkiniz yok.");
        let yeniId = prompt("Yeni RÃ¼tbe ID'sini Girin (0-10 ArasÄ±):\n0: Memur, 5: B.Komiser, 10: MÃ¼dÃ¼r", mevcutRutbe);
        if(yeniId !== null && yeniId !== "") {
            yeniId = parseInt(yeniId);
            if(yeniId >= 0 && yeniId <= 10) {
                database.ref('personel/' + key).update({ rutbe: yeniId });
                alert("RÃ¼tbe gÃ¼ncellendi!");
            } else {
                alert("GeÃ§ersiz RÃ¼tbe ID! (0-10 arasÄ± olmalÄ±)");
            }
        }
    }

    // --- BAÅVURU SÄ°STEMÄ° & WEBHOOK ---
    function basvurulariDinle() {
        database.ref('basvurular').on('value', s => {
            const tb = document.getElementById('basvuruListesi'); tb.innerHTML = ""; let bekleyen = 0;
            let arr = []; s.forEach(c => arr.push({k:c.key, v:c.val()})); arr.reverse();
            
            arr.forEach(i => { 
                const d = i.v; 
                if(d.durum==='Beklemede') bekleyen++; 
                let b = d.durum==='OnaylandÄ±' ? 'badge-green' : (d.durum==='Reddedildi' ? 'badge-red' : 'badge-warn'); 
                
                // Discord ID'yi Linke Ã‡evirme
                let discordLink = `<a href="https://discord.com/users/${d.discord_id}" target="_blank" style="color:#5865F2; text-decoration:none; font-weight:bold;"><i class="fab fa-discord"></i> ${d.discord_id}</a>`;

                tb.innerHTML += `<tr><td>${new Date(d.tarih).toLocaleDateString()}</td><td>${discordLink}</td><td>${d.ic_isim}</td><td><span class="badge ${b}">${d.durum}</span></td><td><button onclick="basvuruIncele('${i.k}')" class="btn btn-blue">Ä°NCELE</button></td></tr>`; 
            });
            document.getElementById('statBasvuru').innerText = bekleyen; 
            document.getElementById('basvuruBadge').style.display = bekleyen > 0 ? 'inline-block' : 'none'; 
            document.getElementById('basvuruBadge').innerText = bekleyen;
        });
    }

    function basvuruIncele(key) {
        seciliBasvuruId = key;
        database.ref('basvurular/'+key).once('value', s => {
            const d = s.val();
            seciliBasvuruData = d;
            let h = `<div class="grid-2"><div><strong>ID:</strong> ${d.discord_id}</div><div><strong>Ä°sim:</strong> ${d.ic_isim}</div></div><hr><h4>Cevaplar:</h4>`;
            for(let k in d.cevaplar) if(!['discord_id','ic_isim','ooc_yas'].includes(k)) h += `<p style="color:#aaa;margin-bottom:2px;">${d.soru_detaylari?d.soru_detaylari[k]:k}</p><div style="background:rgba(0,0,0,0.2);padding:10px;margin-bottom:10px;">${d.cevaplar[k]}</div>`;
            document.getElementById('basvuruDetayIcerik').innerHTML = h; 
            document.getElementById('basvuruIslemButtonlari').innerHTML = `
                <button onclick="durumGuncelle('OnaylandÄ±')" class="btn btn-green">ONAYLA & BÄ°LDÄ°R</button>
                <button onclick="durumGuncelle('Reddedildi')" class="btn btn-red">REDDET</button>
                <button onclick="karaListeyeEkle('${d.discord_id}')" class="btn btn-dark">BANLA</button>`; 
            document.getElementById('basvuruModal').style.display = 'flex';
        });
    }

    function durumGuncelle(durum) { 
        if(aktifRutbeId < 3) return alert("Yetkiniz yetersiz."); 
        database.ref('basvurular/'+seciliBasvuruId).update({durum:durum});
        if(durum === "OnaylandÄ±" && seciliBasvuruData) { sendDiscordWebhook(seciliBasvuruData); }
        modalKapat(); 
    }

    function sendDiscordWebhook(data) {
        const payload = {
            content: `<@${data.discord_id}>`,
            embeds: [{
                title: "ğŸ‘®â€â™‚ï¸ BAÅVURU KABUL EDÄ°LDÄ°",
                description: `Tebrikler! **${data.ic_isim}** isimli karakter baÅŸvurunuz onaylanmÄ±ÅŸtÄ±r.`,
                color: 3066993,
                fields: [
                    { name: "Discord ID", value: data.discord_id, inline: true },
                    { name: "IC Ä°sim", value: data.ic_isim, inline: true },
                    { name: "Ä°ÅŸlem Yapan", value: aktifKullanici, inline: false }
                ],
                footer: { text: "POLNET Otomasyon Sistemi" },
                timestamp: new Date().toISOString()
            }]
        };

        fetch(DISCORD_WEBHOOK_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        }).then(response => { if(response.ok) console.log("Webhook gÃ¶nderildi."); });
    }

    // --- STANDART FONKSÄ°YONLAR ---
    function ruhsatlariDinle() { database.ref('ruhsatlar').on('value', s => { const tb = document.getElementById('ruhsatListesi'); tb.innerHTML = ""; s.forEach(c => { const d = c.val(); let tarihStil = new Date(d.gecerlilik) < new Date() ? "color:red; font-weight:bold;" : ""; tb.innerHTML += `<tr><td>${d.sahip}</td><td><span class="badge badge-blue">${d.tip}</span></td><td style="${tarihStil}">${d.gecerlilik} ${tarihStil?'(DOLDU)':''}</td><td>${d.veren}</td><td><button onclick="dbSil('ruhsatlar/${c.key}')" class="btn btn-red btn-sm">Ä°PTAL</button></td></tr>`; }); }); }
    function mesaiSistemiBaslat() { database.ref('active_shifts').on('value', s => { const tbody = document.getElementById('aktifMesaiBody'); tbody.innerHTML = ""; let count = 0; s.forEach(c => { const d = c.val(); let sure = Math.floor((Date.now() - d.start) / 60000); let rAd = d.rutbeAd || "Bilinmiyor"; tbody.innerHTML += `<tr><td>${d.user}</td><td><span class="badge badge-blue">${rAd}</span></td><td>${new Date(d.start).toLocaleTimeString()}</td><td>${sure} Dk</td></tr>`; count++; if(d.user === aktifKullanici && !myShiftTimer) { myShiftStart = d.start; startLocalTimer(); uiMesaiActive(); } }); document.getElementById('statAktifPersonel').innerText = count; }); }
    function mesaiToggle() { if(!myShiftStart) { database.ref('active_shifts/' + aktifKullanici).set({ user: aktifKullanici, rutbeAd: getRutbeAd(aktifRutbeId), start: Date.now() }); } else { if(confirm("Mesaiyi bitir?")) { database.ref('active_shifts/' + aktifKullanici).remove(); myShiftStart = null; clearInterval(myShiftTimer); myShiftTimer = null; uiMesaiInactive(); } } }
    function startLocalTimer() { if(myShiftTimer) clearInterval(myShiftTimer); myShiftTimer = setInterval(() => { if(!myShiftStart) return; let diff = Date.now() - myShiftStart; let h = Math.floor(diff / 3600000); let m = Math.floor((diff % 3600000) / 60000); let s = Math.floor((diff % 60000) / 1000); document.getElementById('mesaiSayac').innerText = (h<10?'0':'')+h + ":" + (m<10?'0':'')+m + ":" + (s<10?'0':'')+s; }, 1000); }
    function uiMesaiActive() { const c = document.getElementById('kisiselMesaiKart'); c.classList.add('mesai-active'); document.getElementById('mesaiDurumText').innerText = "MESAÄ°DE"; document.getElementById('mesaiDurumText').style.color = "var(--success)"; document.getElementById('btnMesai').innerText = "MESAÄ° BÄ°TÄ°R"; document.getElementById('btnMesai').classList.remove('btn-green'); document.getElementById('btnMesai').classList.add('btn-red'); }
    function uiMesaiInactive() { const c = document.getElementById('kisiselMesaiKart'); c.classList.remove('mesai-active'); document.getElementById('mesaiDurumText').innerText = "MESAÄ° DIÅI"; document.getElementById('mesaiDurumText').style.color = "var(--text-muted)"; document.getElementById('btnMesai').innerText = "MESAÄ°YE BAÅLA"; document.getElementById('btnMesai').classList.remove('btn-red'); document.getElementById('btnMesai').classList.add('btn-green'); document.getElementById('mesaiSayac').innerText = "00:00:00"; }
    
    function cezaListesiniOlustur() { renderCezaListesi(tckDb); }
    function renderCezaListesi(liste) { const container = document.getElementById('cezaListesiContainer'); container.innerHTML = ""; liste.forEach(c => { container.innerHTML += `<div class="ceza-item" onclick="cezaSec(this, ${c.p}, ${c.h})"><div><span class="ceza-code">${c.code}</span><span>${c.ad}</span></div><span class="badge badge-blue">${c.p.toLocaleString()} TL / ${c.h} Kamu</span></div>`; }); }
    let toplamPara = 0; let toplamAy = 0;
    function cezaSec(element, para, ay) { if(element.classList.contains('selected')) { element.classList.remove('selected'); toplamPara -= para; toplamAy -= ay; } else { element.classList.add('selected'); toplamPara += para; toplamAy += ay; } document.getElementById('toplamTutar').innerText = `${toplamPara.toLocaleString()} TL / ${toplamAy} Kamu (Hapis)`; }
    function cezaFiltrele() { const val = document.getElementById('ceza_ara').value.toLowerCase(); const filtrelenmis = tckDb.filter(item => item.ad.toLowerCase().includes(val) || (item.code && item.code.toLowerCase().includes(val))); renderCezaListesi(filtrelenmis); }
    function cezaSifirla() { toplamPara=0; toplamAy=0; renderCezaListesi(tckDb); document.getElementById('toplamTutar').innerText="0 TL / 0 Kamu"; }
    function cezaModalAc() { cezaSifirla(); document.getElementById('cezaModal').style.display = 'flex'; }
    function cezayiKes() { const sahis = document.getElementById('ceza_sahis').value; if(!sahis) return alert("ÅahÄ±s adÄ± girilmedi!"); if(toplamPara === 0 && toplamAy === 0) return alert("HiÃ§bir suÃ§ seÃ§mediniz!"); database.ref('gbt').push({ isim: sahis, tarih: new Date().toISOString(), suc: `TOPLAM: ${toplamPara.toLocaleString()} TL, ${toplamAy} Kamu CezasÄ±`, memur: aktifKullanici }); alert("Ceza Sisteme Ä°ÅŸlendi!"); modalKapat(); }
    function gbtSorgula() { const isim = document.getElementById('gbtInput').value; const div = document.getElementById('gbtSonuc'); div.innerHTML = "AranÄ±yor..."; database.ref('gbt').orderByChild('isim').equalTo(isim).once('value', s => { div.innerHTML = ""; if(s.exists()) { let html = `<h3 style="color:var(--danger)">SABIKA KAYDI BULUNDU</h3>`; s.forEach(c => { let d=c.val(); html += `<div class="card" style="border-left:4px solid var(--danger)"><h4>${d.suc}</h4><p>${new Date(d.tarih).toLocaleDateString()} - Ä°ÅŸleyen: ${d.memur}</p></div>`; }); div.innerHTML = html; } else { div.innerHTML = `<div class="card" style="border-left:4px solid var(--success)"><h3>TEMÄ°Z</h3><p>SabÄ±ka kaydÄ± yok.</p></div>`; } }); }
    
    function ruhsatKaydet() { const sahip = document.getElementById('ruh_sahip').value; const tip = document.getElementById('ruh_tip').value; const tarih = document.getElementById('ruh_tarih').value; if(!sahip || !tarih) return alert("TÃ¼m alanlarÄ± doldurun!"); database.ref('ruhsatlar').push({ sahip: sahip, tip: tip, gecerlilik: tarih, veren: aktifKullanici, verilis_tarihi: Date.now() }); alert("Ruhsat baÅŸarÄ±yla verildi!"); modalKapat(); }
    function plakaSorgula() { const p = document.getElementById('plakaInput').value; const r = document.getElementById('aracSonuc'); if(p === "34 TR 34") r.innerHTML = `<div class="card" style="border-left:5px solid red; text-align:center;"><h1>Ã‡ALINTI ARAÃ‡</h1><p>Aranan ÅahÄ±s: Mehmet YÄ±lmaz</p></div>`; else r.innerHTML = `<div class="card" style="border-left:5px solid green; text-align:center;"><h1>TEMÄ°Z</h1><p>Ruhsat Sahibi: Ahmet Demir</p></div>`; }
    function ohalDegistir() { if(aktifRutbeId !== 10) return; database.ref('sistem/ohal').once('value', s => database.ref('sistem/ohal').set(!s.val())); }
    database.ref('sistem/ohal').on('value', s => { if(s.val()) { document.body.classList.add('ohal-active'); document.getElementById('ohalAlertBar').style.display = 'block'; document.getElementById('ohalBtn').innerText = "âš ï¸ OHAL BÄ°TÄ°R"; } else { document.body.classList.remove('ohal-active'); document.getElementById('ohalAlertBar').style.display = 'none'; document.getElementById('ohalBtn').innerText = "ğŸš¨ OHAL BAÅLAT"; } });
    function dbSil(path) { if(aktifRutbeId >= 5 && confirm("Sil?")) database.ref(path).remove(); }
    function modalKapat() { document.querySelectorAll('.modal').forEach(m=>m.style.display='none'); }
    function modalAc(id){ document.getElementById(id).style.display='flex'; }
    function tabDegistir(id, el) { document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active')); document.querySelectorAll('.menu-item').forEach(m=>m.classList.remove('active-tab')); document.getElementById(id).classList.add('active'); el.classList.add('active-tab'); }
    function tabloAra(i,t){ let v=document.getElementById(i).value.toLowerCase(); document.querySelectorAll('#'+t+' tr').forEach(r=>r.style.display=r.innerText.toLowerCase().includes(v)?'':'none'); }
    function karaListeyeEkle(id=null) { if(aktifRutbeId < 5) return; const d=id||document.getElementById('bl_id').value; database.ref('blacklist').push({discord_id:d, sebep:"YÃ¶netici BanÄ±", tarih:Date.now()}); if(id) durumGuncelle('Reddedildi'); else alert("Eklendi"); }
    function karaListeSil(key) { if(aktifRutbeId < 5) return; if(confirm("Kara listeden Ã§Ä±kar?")) database.ref('blacklist/'+key).remove(); }
</script>
</body>
</html>
