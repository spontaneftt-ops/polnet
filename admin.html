<div class="menu-item" onclick="tabDegistir('basvuruTab', this)"><i class="fas fa-file-signature"></i> Başvurular</div>

<div id="basvuruTab" class="tab-content">
    <h1>Gelen Başvurular</h1>
    <div style="height:600px; overflow-y:auto;">
        <table>
            <thead>
                <tr>
                    <th>Discord</th>
                    <th>Karakter Adı</th>
                    <th>Yaş</th>
                    <th>Durum</th>
                    <th>İşlem</th>
                </tr>
            </thead>
            <tbody id="basvuruListesi"></tbody>
        </table>
    </div>
</div>

<div id="basvuruDetayModal" class="modal">
    <div class="modal-content">
        <div class="modal-header"><h3>Başvuru Detayı</h3><span onclick="modalKapat()" style="cursor:pointer;">X</span></div>
        <div class="modal-body" id="basvuruDetayIcerik"></div>
        <div style="padding:20px; display:flex; gap:10px;">
            <button class="btn btn-green" id="btnOnayla" style="flex:1">ONAYLA</button>
            <button class="btn btn-red" id="btnReddet" style="flex:1">REDDET</button>
        </div>
    </div>
</div>

<script src="config.js"></script>
<script>
    // Mevcut scriptlerin sonuna veya verileriYukle fonksiyonunun altına ekleyin
    database.ref('basvurular').on('value', s => {
        const t = document.getElementById('basvuruListesi');
        t.innerHTML = "";
        if(s.exists()) {
            s.forEach(c => {
                let d = c.val();
                let renk = d.durum === 'Onaylandı' ? '#10b981' : (d.durum === 'Reddedildi' ? '#ef4444' : '#f59e0b');
                t.innerHTML += `<tr>
                    <td>${d.discord_id}</td>
                    <td>${d.ic_isim}</td>
                    <td>${d.ooc_yas}</td>
                    <td style="color:${renk}; font-weight:bold;">${d.durum}</td>
                    <td><button class="btn btn-blue" onclick="basvuruIncele('${c.key}')">İNCELENİSİN</button></td>
                </tr>`;
            });
        }
    });

    function basvuruIncele(key) {
        database.ref('basvurular/' + key).once('value', s => {
            const d = s.val();
            let html = `<h4>Aday: ${d.ic_isim}</h4><hr>`;
            for(let id in d.cevaplar) {
                let soru = (d.soru_detaylari && d.soru_detaylari[id]) ? d.soru_detaylari[id] : id;
                html += `<p><b>${soru}</b>: ${d.cevaplar[id]}</p>`;
            }
            document.getElementById('basvuruDetayIcerik').innerHTML = html;
            document.getElementById('btnOnayla').onclick = () => basvuruKarar(key, 'Onaylandı');
            document.getElementById('btnReddet').onclick = () => {
                let sebep = prompt("Red Sebebi:");
                if(sebep) basvuruKarar(key, 'Reddedildi', sebep);
            };
            modalAc('basvuruDetayModal');
        });
    }

    function basvuruKarar(key, durum, sebep = "") {
        database.ref('basvurular/' + key).update({ durum: durum, red_sebebi: sebep }).then(() => {
            alert("İşlem Başarılı!");
            modalKapat();
        });
    }

    // Modal ve Tab fonksiyonlarının çalıştığından emin olun (Mevcut kodunda zaten var)
</script>
